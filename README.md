# Назначение
Преобразование линейного файла Excel в XML с одной табличной частью.

# Требования
Файл формата ***.xlsx**, 1 лист

* Строка 1 - в столбах наименования Атрибутов (приводятся в нижний регистр в XML)
* * пустое значение Строка1СтолбецN ограничивает разбор столбцов до N-1
* * Префикс **'SP.'** - поле является спецификацией (ТЧ), вне зависимости от порядка в файле
* Данные разбираются начиная со Строки2 первое пустое значение в **Столбец[Настройка: NumColumnHeadKey]**

# Настройки
Настройки в файле **config.cfg**, файл автоматически создается при первом запуске в нужной структуре. 

* NumColumnHeadKey - номер столбца содержащий ключевое поле шапки (SP группируется в шапку)
* XML_ItemId - определяет значение атрибута **itemid** в XML
* XML_ItemSpId - определяет значение атрибута **itemspid** в XML
* SkipEmptyAttr - (true/false) True - на заполненные ячейки в Excel не будут формировать атрибуты в XML 
* IsPrintDebug - (true/false) вывод отладочных сообщений
* IsPrettyPrint - (true/false) форматирование Pretty (с переносами) результирующего XML файла. Не рекомендуется к использованию. 


# Алгоритм
1) Все файлы в текущей директории ***.xlsx**
2) Результирующий файл с тем же именем, но с расширением ***.xml** перезаписывается при каждом запуске
3) Формируется уникальный список [Шапки] по значениям в столбце **[Настройка: NumColumnHeadKey]**
4) Для каждой [Шапки] создается элемент **itemid** (из первой строки, атрибуты без префикса 'SP.') и спецификация **itemspid** все элементы [Шапки] атрибуты c префиксом **'SP.'**
5) Если нет заполненных атрибутов c префиксом **'SP.'**, секция **itemspid** не создается


Структура файла результирующего файла
```xml
<?xml version="1.0" encoding="utf-8"?>
<root>
    <fileinfo version="ExcelToXML" datetime="[Дата\время формирования]"/>
    <item itemid="[Настройка: XML_ItemId]">
    <item code="Имена атрибутов из 1 строки файла">
      <itemsp itemspid="[Настройка: XML_ItemSpId]">
        <item num="Имена атрибутов из 1 строки файла с префиксом SP"/>
        <item num="Кол-во элементов сгруппированных по столбцу [Настройка: NumColumnHeadKey]"/>
      </itemsp>
    </item>
    <item code="Кол-во уникальных элементов по столбцу [Настройка: NumColumnHeadKey]"/>
  </item>
</root>
```


